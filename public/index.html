<!doctype html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="./vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://unpkg.com/tachyons@4.12.0/css/tachyons.min.css" />
    <link rel="stylesheet" href="./global.css" />
    <link rel="manifest" href="./manifest.webmanifest" />
    <title>Avatar Maker</title>
  </head>

  <body>
    <div id="app"></div>
    <script src="./js/main.js"></script>
    <script>
    const isLocalhost = ["localhost", "127.0.0.1", "[::1]"].includes(window.location.hostname);

    if ("serviceWorker" in navigator) {
      window.addEventListener("load", async () => {
        if (isLocalhost) {
          const regs = await navigator.serviceWorker.getRegistrations();
          await Promise.all(regs.map((r) => r.unregister()));
          if (window.caches) {
            const keys = await caches.keys();
            await Promise.all(keys.map((k) => caches.delete(k)));
          }
          return;
        }

        const reg = await navigator.serviceWorker.register("./sw.js?v=3", {
          updateViaCache: "none"
        });
        reg.update();
      });
    }
  </script>
  </body>

</html>
